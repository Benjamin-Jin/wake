def local_utf8proc variant =
  def cflags = "-I{here}", Nil
  def headers = source "{here}/utf8proc_data.c", sources here '.*\.h'
  def compile x = compileC variant cflags headers (source "{here}/{x}")
  def objects = ("utf8proc.c", Nil) | map compile
  CPackage "2.2.0" headers objects cflags Nil

global def system_utf8proc _ = pkgConfig "utf8proc"

global def utf8proc variant =
  local_utf8proc variant
